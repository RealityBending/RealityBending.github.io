<!DOCTYPE html>
<!-- This site was created with Hugo Blox. https://hugoblox.com -->
<!-- Last Published: May 24, 2024 --><html lang="en-us" >


<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  
  
  
    <meta name="generator" content="Hugo Blox Builder 5.9.7" />
  

  
  












  
  










  







  
  
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  

  
  
  
    
      
      <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap">
      <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media="print" onload="this.media='all'">
    
  

  
  

  
  

  

  <link rel="stylesheet" href="/css/vendor-bundle.min.26c458e6907dc03073573976b7f4044e.css" media="print" onload="this.media='all'">

  
  
  
    
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1.9.4/css/academicons.min.css" integrity="sha512-IW0nhlW5MgNydsXJO40En2EoCkTTjZhI3yuODrZIc8cQ4h1XcF53PsqDHa09NqnkXuIe0Oiyyj171BqZFwISBw==" crossorigin="anonymous" media="print" onload="this.media='all'">
    

    
    
    
    
      
      
    
    
    

    
    
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet@1.7.1/dist/leaflet.min.css" integrity="" crossorigin="anonymous" media="print" onload="this.media='all'">
    

    

    
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      
        
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
  

  
  
  
  
  
  
  <link rel="stylesheet" href="/css/wowchemy.e60d16fbfde4e9e2ab3747eec8c94e52.css" />

  
  
  

  
  
  
  
  
  
  
    
    
    <link rel="stylesheet" href="/css/libs/chroma/github-light.min.css" title="hl-light" media="print" onload="this.media='all'" >
    <link rel="stylesheet" href="/css/libs/chroma/dracula.min.css" title="hl-dark" media="print" onload="this.media='all'" disabled>
  

  
  






<script async src="https://www.googletagmanager.com/gtag/js?id=G-6PL469S5F7"></script>
<script>
  window.dataLayer = window.dataLayer || [];

  function gtag() {
      dataLayer.push(arguments);
  }

  function trackOutboundLink(url, target) {
    gtag('event', 'click', {
         'event_category': 'outbound',
         'event_label': url,
         'transport_type': 'beacon',
         'event_callback': function () {
           if (target !== '_blank') {
             document.location = url;
           }
         }
    });
    console.debug("Outbound link clicked: " + url);
  }

  function onClickCallback(event) {
    if ((event.target.tagName !== 'A') || (event.target.host === window.location.host)) {
      return;
    }
    trackOutboundLink(event.target, event.target.getAttribute('target'));  
  }

  gtag('js', new Date());
  gtag('config', 'G-6PL469S5F7', {});
  gtag('set', {'cookie_flags': 'SameSite=None;Secure'});

  
  document.addEventListener('click', onClickCallback, false);
</script>
























  
  
  






  <meta name="author" content="Dominique Makowski" />





  

<meta name="description" content="We compare different methods (individual models, Bayesian models with informative priors, random effects from mixed models) to extract individual scores from repeated measures tasks." />



<link rel="alternate" hreflang="en-us" href="https://realitybending.github.io/post/2020-09-14-individual_scores/" />
<link rel="canonical" href="https://realitybending.github.io/post/2020-09-14-individual_scores/" />



  <link rel="manifest" href="/manifest.webmanifest" />



<link rel="icon" type="image/png" href="/media/icon_hu43f9474a7b47cfb59c41895962a4d3bc_15500_32x32_fill_lanczos_center_3.png" />
<link rel="apple-touch-icon" type="image/png" href="/media/icon_hu43f9474a7b47cfb59c41895962a4d3bc_15500_180x180_fill_lanczos_center_3.png" />

<meta name="theme-color" content="#9C27B0" />










  






<meta property="twitter:card" content="summary_large_image" />

  <meta property="twitter:site" content="@Dom_Makowski" />
  <meta property="twitter:creator" content="@Dom_Makowski" />
<meta property="twitter:image" content="https://realitybending.github.io/post/2020-09-14-individual_scores/featured.png" />



  

<meta property="og:type" content="article" />
<meta property="og:site_name" content="Reality Bending Lab" />
<meta property="og:url" content="https://realitybending.github.io/post/2020-09-14-individual_scores/" />
<meta property="og:title" content="How to extract individual scores from repeated measures | Reality Bending Lab" />
<meta property="og:description" content="We compare different methods (individual models, Bayesian models with informative priors, random effects from mixed models) to extract individual scores from repeated measures tasks." /><meta property="og:image" content="https://realitybending.github.io/post/2020-09-14-individual_scores/featured.png" /><meta property="og:locale" content="en-us" />

  
    <meta
      property="article:published_time"
      content="2020-09-14T00:00:00&#43;00:00"
    />
  
  
    <meta property="article:modified_time" content="2020-09-14T00:00:00&#43;00:00">
  






    






  




<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://realitybending.github.io/post/2020-09-14-individual_scores/"
  },
  "headline": "How to extract individual scores from repeated measures",
  
  "image": [
    "https://realitybending.github.io/post/2020-09-14-individual_scores/featured.png"
  ],
  
  "datePublished": "2020-09-14T00:00:00Z",
  "dateModified": "2020-09-14T00:00:00Z",
  
  "author": {
    "@type": "Person",
    "name": "Dominique Makowski"
  },
  
  "publisher": {
    "@type": "Organization",
    "name": "Reality Bending Lab",
    "logo": {
      "@type": "ImageObject",
      "url": "https://realitybending.github.io/media/icon_hu43f9474a7b47cfb59c41895962a4d3bc_15500_192x192_fill_lanczos_center_3.png"
    }
  },
  "description": "We compare different methods (individual models, Bayesian models with informative priors, random effects from mixed models) to extract individual scores from repeated measures tasks."
}
</script>

  

  




  
  
  

  
  

  


  
  <title>How to extract individual scores from repeated measures | Reality Bending Lab</title>

  
  
  
  











</head>


<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class="page-wrapper   " data-wc-page-id="c18d424dc532938378275911561d4c91" >

  
  
  
  
  
  
  
  
  
  <script src="/js/wowchemy-init.min.4d86d96dd75d4de5d4f64fa2bd71da1c.js"></script>

  


<aside class="search-modal" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#" aria-label="Close"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search" class="form-control"
        aria-label="Search...">
        
      </div>

      
      

      

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>



  <div class="page-header header--fixed">
  
  
  
  
  












<header>
  <nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
    <div class="container-xl">

      
      <div class="d-none d-lg-inline-flex">
        <a class="navbar-brand" href="/">Reality Bending Lab</a>
      </div>
      

      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar-content" aria-controls="navbar-content" aria-expanded="false" aria-label="Toggle navigation">
      <span><i class="fas fa-bars"></i></span>
      </button>
      

      
      <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
        <a class="navbar-brand" href="/">Reality Bending Lab</a>
      </div>
      

      
      
      <div class="navbar-collapse main-menu-item collapse justify-content-end" id="navbar-content">

        
        <ul class="navbar-nav d-md-inline-flex">
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
          

          <li class="nav-item">
            <a class="nav-link " href="/people/"><span>People</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
          

          <li class="nav-item">
            <a class="nav-link " href="/research/"><span>Research</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
          

          <li class="nav-item">
            <a class="nav-link  active" href="/post/"><span>Blog</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
          

          <li class="nav-item">
            <a class="nav-link " href="/publication/"><span>Publications</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/research#participate"><span>Participate</span></a>
          </li>

          
          

          
          <li class="nav-item dropdown">
            <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-haspopup="true"><span>Join us</span><span class="caret"></span>
            </a>
            <div class="dropdown-menu">
              
                <a class="dropdown-item" href="/jobs/postdoc/"><span>Postdoc</span></a>
              
                <a class="dropdown-item" href="/jobs/phd/"><span>PhD</span></a>
              
                <a class="dropdown-item" href="/jobs/assistant/"><span>Research Assistant</span></a>
              
                <a class="dropdown-item" href="/jobs/intern/"><span>Internship</span></a>
              
                <a class="dropdown-item" href="/jobs/projects/"><span>Research Projects</span></a>
              
            </div>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#11_contact"><span>Contact</span></a>
          </li>

          
          

          

          
          
          
            
              
            
          

          

          
          
          
          

          
            
              
              
            
            
          

          <li class="nav-item">
            <a class="nav-link " href="https://github.com/RealityBending" target="_blank" rel="noopener"><span><i class="fab fa-github"; font-size: 1rem; line-height: 1.25"></i></span></a>
          </li>

          
          

        

          
        </ul>
      </div>

      <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">

        
        
          
        

        
        
        
        <li class="nav-item">
          <a class="nav-link js-search" href="#" aria-label="Search"><i class="fas fa-search" aria-hidden="true"></i></a>
        </li>
        

        
        
        

        
        

      </ul>

    </div>
  </nav>
</header>


  </div>

  <div class="page-body">
    
    
    

    <article class="article">

  






















  
  



<div class="article-container pt-3">
  <h1>How to extract individual scores from repeated measures</h1>

  
  <p class="page-subtitle">We compare different methods (individual models, Bayesian models with informative priors, random effects from mixed models) to extract individual scores from repeated measures tasks.</p>
  

  


<div class="article-metadata">

  
  
  
  
  <div>
    

  <span >
      <a href="/authors/dominique-makowski/">Dominique Makowski</a></span>
  </div>
  
  

  
  <span class="article-date">
    
    
      
    
    Sep 14, 2020
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    8 min read
  </span>
  

  
  
  
  

  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fas fa-folder mr-1"></i><a href="/category/r/">R</a>, <a href="/category/statistics/">Statistics</a></span>
  

</div>

  





</div>


<div class="article-header article-container featured-image-wrapper mt-4 mb-4" style="max-width: 720px; max-height: 432px;">
  <div style="position: relative">
    <img src="/post/2020-09-14-individual_scores/featured_hue07ff18023a09a516a6f4e65447299b7_77817_4696dfa9fd0870109fe3fb8c68619925.webp" width="720" height="432" alt="" class="featured-image">
    <span class="article-header-caption">Absolute difference between true individual scores and the scores estimated via different methods.</span>
  </div>
</div>



  <div class="article-container">

    <div class="article-style">
      <h3 id="introduction">Introduction</h3>
<p>Many psychology fields require to extract individual scores, i.e., point-estimates (<em>i.e.</em>, a single value) for a participant/patient, to be used as an index of something and later interpreted or re-used in further statistical analyses. This single index is often derived from several &ldquo;trials&rdquo;. For instance, the reaction times in the condition A (let&rsquo;s say, the baseline) will be <strong>averaged</strong> together, and the same will be done with the condition B. Finally, the difference between these two means will be used an the <strong>individual score</strong> for a given participant.</p>
<p>However, we can intuitively feel that we <strong>lose a lot of information</strong> when averaging these scores. Do we deal appropriately with the variability related to individuals, conditions, or the noise aggravated by potential outliers? This is especially important when working with a limited amount of trials.</p>
<p>With the advent of recent computational advances, new easy-to-implement alternatives emerge. For instance, <strong>one can &ldquo;model&rdquo; the effects at an individual level</strong> (e.g., the simplest case, for the two conditions paradigm described above, would be a linear regression with the condition as a unique predictor), and use the <strong>parameters</strong> of each model as individual scores (e.g., the &ldquo;slope&rdquo; coefficient of the effect of the manipulation), rather than the raw mean. This opens up the possibility of including covariates and take into account other sources of known variability, which could lead to better estimates.</p>
<p>However, individual models are also sensitive to outliers and noise. Thus, another possibility is to <strong>model the effects at the population level</strong> and, <em>at the same time</em>, at the individual level. This can be achieved by modelling the participants as a <strong>random factor in a mixed model</strong>. In this case, the individual estimates might benefit from the population estimates. In other words, the effects at the population level will &ldquo;constrain&rdquo; or &ldquo;guide&rdquo; the estimation at an individual level to potentially limit extreme parameters.</p>
<p>Unfortunately, the above method requires to have all the data at hand, to be able to fit the population model. This is often not the case in on-going acquisition, or in neuropsychological contexts, in which the practitioners simply acquire data for one patient, and have to compute individual scores, without having access to the detailed population data. Thus, an in-between alternative could make use of <strong>Bayesian models</strong>, in which the population effects (for instance, the mean effect of the condition) could be entered as an informative <strong>prior</strong> in the individual models to, again, &ldquo;guide&rdquo; the estimation at an individual level and hopefully limit the impact of noise or outliers observations.</p>
<p>In this post, the aim is to compare these 4 methods (basic individual model - equivalent to using the raw mean, population model, individual model with informative priors) in recovering the &ldquo;true&rdquo; effects using a simulated dataset.</p>
<h3 id="results">Results</h3>
<h4 id="generate-data">Generate Data</h4>
<p>We generate several datasets in which we manipulate the number of participants, in which the score of interest is the effect of a manipulation as compared to a baseline condition. 20 trials per condition will be generated with a known &ldquo;true&rdquo; effect (the centre of the distribution from which the data is generated). Gaussian noise of varying standard deviation will be added to create a natural variability (See the functions&rsquo; definition below).</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">tidyverse</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">easystats</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">data</span> <span class="o">&lt;-</span> <span class="nf">get_data</span><span class="p">(</span><span class="n">n_participants</span><span class="o">=</span><span class="m">1000</span><span class="p">,</span> <span class="n">n_trials</span><span class="o">=</span><span class="m">20</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">results</span> <span class="o">&lt;-</span> <span class="nf">get_results</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span></span></code></pre></div><div class="figure">
<img src="individual.png" alt="*Example of a dataset containing 20 participants (shown with different colors). As can be seen, we introduced modulations in the inter- and intra- individual variability.*" width="1575" />
<p class="caption">Figure 1: *Example of a dataset containing 20 participants (shown with different colors). As can be seen, we introduced modulations in the inter- and intra- individual variability.*</p>
</div>
<p>We will then compare the scores obtained by each method to the &ldquo;true&rdquo; score of each participant by substracting them from one another. As such, for each method, we obtain the absolute &ldquo;distance&rdquo; from the true score.</p>
<h4 id="fit-model">Fit model</h4>
<p>Contrast analysis will be applied to compare the different methods together.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">model</span> <span class="o">&lt;-</span> <span class="nf">lm</span><span class="p">(</span><span class="n">Diff_Abs</span> <span class="o">~</span> <span class="n">Method</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">results</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">modelbased</span><span class="o">::</span><span class="nf">estimate_contrasts</span><span class="p">(</span><span class="n">model</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="nf">arrange</span><span class="p">(</span><span class="n">Difference</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="nf">mutate</span><span class="p">(</span><span class="n">Level1</span> <span class="o">=</span> <span class="n">stringr</span><span class="o">::</span><span class="nf">str_remove</span><span class="p">(</span><span class="n">Level1</span><span class="p">,</span> <span class="s">&#34;Diff_&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">         <span class="n">Level2</span> <span class="o">=</span> <span class="n">stringr</span><span class="o">::</span><span class="nf">str_remove</span><span class="p">(</span><span class="n">Level2</span><span class="p">,</span> <span class="s">&#34;Diff_&#34;</span><span class="p">))</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">  <span class="nf">select</span><span class="p">(</span><span class="n">Level1</span><span class="p">,</span> <span class="n">Level2</span><span class="p">,</span> <span class="n">Difference</span><span class="p">,</span> <span class="n">CI_low</span><span class="p">,</span> <span class="n">CI_high</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## Level1                 |                 Level2 | Difference |            CI |      p
</span></span><span class="line"><span class="cl">## -------------------------------------------------------------------------------------
</span></span><span class="line"><span class="cl">## IndividualModel_Priors |        PopulationModel |  -1.85e-03 | [-0.01, 0.01] | &gt; .999
</span></span><span class="line"><span class="cl">## IndividualModel_Freq   |        PopulationModel |   1.70e-03 | [-0.01, 0.01] | &gt; .999
</span></span><span class="line"><span class="cl">## IndividualModel_Freq   | IndividualModel_Priors |   3.55e-03 | [-0.01, 0.01] | &gt; .999
</span></span></code></pre></div><h4 id="visualize-the-results">Visualize the results</h4>
<div class="figure">
<img src="featured.png" alt="*Average accuracy of the different methods (the closest to 0 the better).*" width="2250" />
<p class="caption">Figure 2: *Average accuracy of the different methods (the closest to 0 the better).*</p>
</div>
<div class="figure">
<img src="n_participants.png" alt="*Accuracy depending on the number of total participants in the dataset.*" width="2250" />
<p class="caption">Figure 3: *Accuracy depending on the number of total participants in the dataset.*</p>
</div>
<h3 id="conclusion">Conclusion</h3>
<p>Though not significantly different, it seems that <strong>raw basic estimates</strong> (that rely only on the individual data) <strong>perform consistently worse than the population model or individual models informed by priors</strong>, especially for small datasets (between 10 and 100 participants) - though again, the difference is tiny in our simulated dataset. In the absence of the whole population dataset, it seems that using individual Bayesian model with informative priors (derived from the population model) is a safe alternative.</p>
<h3 id="functions">Functions</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">tidyverse</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">easystats</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">rstanarm</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">ggdist</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Get data ----------------------------------------------------------------</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">get_data</span> <span class="o">&lt;-</span> <span class="kr">function</span><span class="p">(</span><span class="n">n_participants</span> <span class="o">=</span> <span class="m">10</span><span class="p">,</span> <span class="n">n_trials</span> <span class="o">=</span> <span class="m">20</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="m">1.5</span><span class="p">,</span> <span class="n">var</span> <span class="o">=</span> <span class="m">3</span><span class="p">,</span> <span class="n">noise</span> <span class="o">=</span> <span class="m">0.1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">scores_baseline</span> <span class="o">&lt;-</span> <span class="nf">rnorm</span><span class="p">(</span><span class="n">n_participants</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">scores_condition</span> <span class="o">&lt;-</span> <span class="nf">rnorm</span><span class="p">(</span><span class="n">n_participants</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="m">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">variances</span> <span class="o">&lt;-</span> <span class="nf">rbeta</span><span class="p">(</span><span class="n">n_participants</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">8</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">variances</span> <span class="o">&lt;-</span> <span class="m">0.1</span> <span class="o">+</span> <span class="n">variances</span> <span class="o">*</span> <span class="p">(</span><span class="n">var</span> <span class="o">/</span> <span class="nf">max</span><span class="p">(</span><span class="n">variances</span><span class="p">))</span> <span class="c1"># Rescale</span>
</span></span><span class="line"><span class="cl">  <span class="n">noise_sd</span> <span class="o">&lt;-</span> <span class="nf">abs</span><span class="p">(</span><span class="nf">rnorm</span><span class="p">(</span><span class="n">n_participants</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="n">noise</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">data</span> <span class="o">&lt;-</span> <span class="nf">data.frame</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">  <span class="kr">for</span> <span class="p">(</span><span class="n">i</span> <span class="kr">in</span> <span class="m">1</span><span class="o">:</span><span class="n">n_participants</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">a</span> <span class="o">&lt;-</span> <span class="nf">rnorm</span><span class="p">(</span><span class="n">n_trials</span><span class="p">,</span> <span class="n">scores_baseline[i]</span><span class="p">,</span> <span class="n">variances[i]</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">b</span> <span class="o">&lt;-</span> <span class="nf">rnorm</span><span class="p">(</span><span class="n">n_trials</span><span class="p">,</span> <span class="n">scores_condition[i]</span><span class="p">,</span> <span class="n">variances[i]</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">a</span> <span class="o">&lt;-</span> <span class="n">a</span> <span class="o">+</span> <span class="nf">rnorm</span><span class="p">(</span><span class="n">n_trials</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="n">noise_sd[i]</span><span class="p">)</span> <span class="c1"># Add noise</span>
</span></span><span class="line"><span class="cl">    <span class="n">b</span> <span class="o">&lt;-</span> <span class="n">b</span> <span class="o">+</span> <span class="nf">rnorm</span><span class="p">(</span><span class="n">n_trials</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="n">noise_sd[i]</span><span class="p">)</span> <span class="c1"># Add noise</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span> <span class="o">&lt;-</span> <span class="nf">rbind</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nf">data.frame</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">      <span class="s">&#34;Participant&#34;</span> <span class="o">=</span> <span class="nf">sprintf</span><span class="p">(</span><span class="s">&#34;S%02d&#34;</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">      <span class="s">&#34;Y&#34;</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">      <span class="s">&#34;Score_True&#34;</span> <span class="o">=</span> <span class="nf">rep</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">scores_baseline[i]</span><span class="p">,</span> <span class="n">scores_condition[i]</span><span class="p">),</span> <span class="n">each</span> <span class="o">=</span> <span class="n">n_trials</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">      <span class="s">&#34;Condition&#34;</span> <span class="o">=</span> <span class="nf">rep</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="s">&#34;Baseline&#34;</span><span class="p">,</span> <span class="s">&#34;Manipulation&#34;</span><span class="p">),</span> <span class="n">each</span> <span class="o">=</span> <span class="n">n_trials</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">))</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="n">data</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Visualize data -----------------------------------------------------------</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">p</span> <span class="o">&lt;-</span> <span class="nf">get_data</span><span class="p">(</span><span class="n">n_participants</span> <span class="o">=</span> <span class="m">20</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="nf">group_by</span><span class="p">(</span><span class="n">Participant</span><span class="p">,</span> <span class="n">Condition</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="nf">mutate</span><span class="p">(</span><span class="n">mean</span> <span class="o">=</span> <span class="nf">mean</span><span class="p">(</span><span class="n">Y</span><span class="p">))</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">y</span> <span class="o">=</span> <span class="n">Y</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">Condition</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="n">Participant</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">Participant</span><span class="p">,</span> <span class="n">group</span> <span class="o">=</span> <span class="n">Participant</span><span class="p">))</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">geom_line</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">y</span> <span class="o">=</span> <span class="n">mean</span><span class="p">),</span> <span class="n">position</span> <span class="o">=</span> <span class="nf">position_dodge</span><span class="p">(</span><span class="n">width</span> <span class="o">=</span> <span class="m">0.66</span><span class="p">))</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="n">ggdist</span><span class="o">::</span><span class="nf">stat_eye</span><span class="p">(</span><span class="n">point_interval</span> <span class="o">=</span> <span class="n">ggdist</span><span class="o">::</span><span class="n">mean_hdi</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="m">0.66</span><span class="p">,</span> <span class="n">position</span> <span class="o">=</span> <span class="nf">position_dodge</span><span class="p">(</span><span class="n">width</span> <span class="o">=</span> <span class="m">0.66</span><span class="p">),</span> <span class="n">.width</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">0.95</span><span class="p">))</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">ylab</span><span class="p">(</span><span class="s">&#34;Score&#34;</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">theme_modern</span><span class="p">()</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">theme</span><span class="p">(</span><span class="n">legend.position</span> <span class="o">=</span> <span class="s">&#34;none&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">ggsave</span><span class="p">(</span><span class="s">&#34;individual.png&#34;</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="m">7</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="m">7</span><span class="p">,</span> <span class="n">dpi</span> <span class="o">=</span> <span class="m">450</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Get results -------------------------------------------------------------</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">get_results</span> <span class="o">&lt;-</span> <span class="kr">function</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1"># Raw method ----</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">results</span> <span class="o">&lt;-</span> <span class="n">data</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">    <span class="nf">group_by</span><span class="p">(</span><span class="n">Participant</span><span class="p">,</span> <span class="n">Condition</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">    <span class="nf">summarise_all</span><span class="p">(</span><span class="n">mean</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">    <span class="nf">rename</span><span class="p">(</span><span class="s">&#34;Score_Raw&#34;</span> <span class="o">=</span> <span class="s">&#34;Y&#34;</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">    <span class="nf">arrange</span><span class="p">(</span><span class="n">Condition</span><span class="p">,</span> <span class="n">Participant</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">    <span class="nf">ungroup</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1"># Population model ----</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">model</span> <span class="o">&lt;-</span> <span class="n">lme4</span><span class="o">::</span><span class="nf">lmer</span><span class="p">(</span><span class="n">Y</span> <span class="o">~</span> <span class="n">Condition</span> <span class="o">+</span> <span class="p">(</span><span class="m">1</span> <span class="o">+</span> <span class="n">Condition</span> <span class="o">|</span> <span class="n">Participant</span><span class="p">),</span> <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">fixed</span> <span class="o">&lt;-</span> <span class="n">insight</span><span class="o">::</span><span class="nf">get_parameters</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">effects</span> <span class="o">=</span> <span class="s">&#34;fixed&#34;</span><span class="p">)</span><span class="o">$</span><span class="n">Estimate</span>
</span></span><span class="line"><span class="cl">  <span class="n">random</span> <span class="o">&lt;-</span> <span class="n">insight</span><span class="o">::</span><span class="nf">get_parameters</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">effects</span> <span class="o">=</span> <span class="s">&#34;random&#34;</span><span class="p">)</span><span class="o">$</span><span class="n">Participant</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1"># Transform coefs into scores</span>
</span></span><span class="line"><span class="cl">  <span class="n">pop_baseline</span> <span class="o">&lt;-</span> <span class="n">random[</span><span class="p">,</span> <span class="m">1</span><span class="n">]</span> <span class="o">+</span> <span class="n">fixed[1]</span>
</span></span><span class="line"><span class="cl">  <span class="n">pop_manipulation</span> <span class="o">&lt;-</span> <span class="n">pop_baseline</span> <span class="o">+</span> <span class="n">random[</span><span class="p">,</span> <span class="m">2</span><span class="n">]</span> <span class="o">+</span> <span class="n">fixed[2]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">results</span><span class="o">$</span><span class="n">Score_PopulationModel</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="n">pop_baseline</span><span class="p">,</span> <span class="n">pop_manipulation</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1"># Individual model ----</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">individual_model_data</span> <span class="o">&lt;-</span> <span class="nf">data.frame</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">  <span class="kr">for</span> <span class="p">(</span><span class="n">participant</span> <span class="kr">in</span> <span class="nf">unique</span><span class="p">(</span><span class="n">data</span><span class="o">$</span><span class="n">Participant</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">cat</span><span class="p">(</span><span class="s">&#34;.&#34;</span><span class="p">)</span> <span class="c1"># Print progress</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">dat</span> <span class="o">&lt;-</span> <span class="n">data[data</span><span class="o">$</span><span class="n">Participant</span> <span class="o">==</span> <span class="n">participant</span><span class="p">,</span> <span class="n">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># Frequentist</span>
</span></span><span class="line"><span class="cl">    <span class="n">model1</span> <span class="o">&lt;-</span> <span class="nf">lm</span><span class="p">(</span><span class="n">Y</span> <span class="o">~</span> <span class="n">Condition</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">dat</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">nopriors</span> <span class="o">&lt;-</span> <span class="n">parameters</span><span class="o">::</span><span class="nf">parameters</span><span class="p">(</span><span class="n">model1</span><span class="p">)</span><span class="o">$</span><span class="n">Coefficient</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># Bayesian without priors</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># model2 &lt;- stan_glm(Y ~ Condition, data = dat, refresh = 0)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># bayes &lt;- parameters::parameters(model2)$Median</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># Bayesian with Priors</span>
</span></span><span class="line"><span class="cl">    <span class="n">model3</span> <span class="o">&lt;-</span> <span class="nf">stan_glm</span><span class="p">(</span><span class="n">Y</span> <span class="o">~</span> <span class="n">Condition</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="n">data</span> <span class="o">=</span> <span class="n">dat</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="n">refresh</span> <span class="o">=</span> <span class="m">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="n">prior</span> <span class="o">=</span> <span class="nf">normal</span><span class="p">(</span><span class="n">fixed[1]</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">      <span class="n">prior_intercept</span> <span class="o">=</span> <span class="nf">normal</span><span class="p">(</span><span class="n">fixed[2]</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">priors</span> <span class="o">&lt;-</span> <span class="n">parameters</span><span class="o">::</span><span class="nf">parameters</span><span class="p">(</span><span class="n">model3</span><span class="p">)</span><span class="o">$</span><span class="n">Median</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">individual_model_data</span> <span class="o">&lt;-</span> <span class="nf">rbind</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">      <span class="n">individual_model_data</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nf">data.frame</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="s">&#34;Participant&#34;</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="n">participant</span><span class="p">,</span> <span class="n">participant</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="s">&#34;Condition&#34;</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#34;Baseline&#34;</span><span class="p">,</span> <span class="s">&#34;Manipulation&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="s">&#34;Score_IndividualModel&#34;</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="n">nopriors[1]</span><span class="p">,</span> <span class="n">nopriors[1]</span> <span class="o">+</span> <span class="n">nopriors[2]</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># &#34;Score_IndividualModel_Bayes&#34; = c(bayes[1], bayes[1] + bayes[2]),</span>
</span></span><span class="line"><span class="cl">        <span class="s">&#34;Score_IndividualModel_Priors&#34;</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="n">priors[1]</span><span class="p">,</span> <span class="n">priors[1]</span> <span class="o">+</span> <span class="n">priors[2]</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">results</span> <span class="o">&lt;-</span> <span class="nf">merge</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">individual_model_data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1"># Clean output ----</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">diff</span> <span class="o">&lt;-</span> <span class="n">results</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mutate</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">      <span class="c1"># Diff_Raw = Score_True - Score_Raw,</span>
</span></span><span class="line"><span class="cl">      <span class="n">Diff_PopulationModel</span> <span class="o">=</span> <span class="n">Score_True</span> <span class="o">-</span> <span class="n">Score_PopulationModel</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="n">Diff_IndividualModel</span> <span class="o">=</span> <span class="n">Score_True</span> <span class="o">-</span> <span class="n">Score_IndividualModel</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="c1"># Diff_IndividualModel_Bayes = Score_True - Score_IndividualModel_Bayes,</span>
</span></span><span class="line"><span class="cl">      <span class="n">Diff_IndividualModel_Priors</span> <span class="o">=</span> <span class="n">Score_True</span> <span class="o">-</span> <span class="n">Score_IndividualModel_Priors</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">    <span class="nf">select</span><span class="p">(</span><span class="n">Participant</span><span class="p">,</span> <span class="n">Condition</span><span class="p">,</span> <span class="nf">starts_with</span><span class="p">(</span><span class="s">&#34;Diff&#34;</span><span class="p">))</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">    <span class="nf">pivot_longer</span><span class="p">(</span><span class="nf">starts_with</span><span class="p">(</span><span class="s">&#34;Diff&#34;</span><span class="p">),</span> <span class="n">names_to</span> <span class="o">=</span> <span class="s">&#34;Method&#34;</span><span class="p">,</span> <span class="n">values_to</span> <span class="o">=</span> <span class="s">&#34;Diff&#34;</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mutate</span><span class="p">(</span><span class="n">Diff_Abs</span> <span class="o">=</span> <span class="nf">abs</span><span class="p">(</span><span class="n">Diff</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">diff</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Analysis ----------------------------------------------------------------</span>
</span></span><span class="line"><span class="cl"><span class="n">results</span> <span class="o">&lt;-</span> <span class="nf">data.frame</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="kr">for</span><span class="p">(</span><span class="n">n</span> <span class="kr">in</span> <span class="nf">seq.int</span><span class="p">(</span><span class="m">10</span><span class="p">,</span> <span class="m">300</span><span class="p">,</span> <span class="n">length.out</span> <span class="o">=</span> <span class="m">10</span><span class="p">)){</span>
</span></span><span class="line"><span class="cl">  <span class="n">data</span> <span class="o">&lt;-</span> <span class="nf">get_data</span><span class="p">(</span><span class="n">n_participants</span> <span class="o">=</span> <span class="nf">round</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="n">n_trials</span> <span class="o">=</span> <span class="m">20</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">rez</span> <span class="o">&lt;-</span> <span class="nf">get_results</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">    <span class="nf">select</span><span class="p">(</span><span class="o">-</span><span class="n">Participant</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">    <span class="nf">group_by</span><span class="p">(</span><span class="n">Condition</span><span class="p">,</span> <span class="n">Method</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">    <span class="nf">summarise_all</span><span class="p">(</span><span class="n">mean</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mutate</span><span class="p">(</span><span class="n">n_Participants</span> <span class="o">=</span> <span class="n">n</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">           <span class="n">Method</span> <span class="o">=</span> <span class="nf">as.factor</span><span class="p">(</span><span class="n">Method</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">           <span class="n">Dataset</span><span class="o">=</span><span class="nf">paste0</span><span class="p">(</span><span class="s">&#34;Dataset&#34;</span><span class="p">,</span> <span class="nf">round</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="m">2</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl">  <span class="n">results</span> <span class="o">&lt;-</span> <span class="nf">rbind</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">rez</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nf">print</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="c1"># Print progress</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># model &lt;- mgcv::gam(Diff_Abs ~ Method + s(n_Participants, by = Method), data = results)</span>
</span></span><span class="line"><span class="cl"><span class="n">model</span> <span class="o">&lt;-</span> <span class="nf">lm</span><span class="p">(</span><span class="n">Diff_Abs</span> <span class="o">~</span> <span class="n">Method</span> <span class="o">*</span> <span class="nf">poly</span><span class="p">(</span><span class="n">n_Participants</span><span class="p">,</span> <span class="m">3</span><span class="p">),</span> <span class="n">data</span> <span class="o">=</span> <span class="n">results</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">parameters</span><span class="o">::</span><span class="nf">parameters</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">contrasts</span> <span class="o">&lt;-</span> <span class="n">modelbased</span><span class="o">::</span><span class="nf">estimate_contrasts</span><span class="p">(</span><span class="n">model</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="nf">arrange</span><span class="p">(</span><span class="n">Difference</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="nf">mutate</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">Level1</span> <span class="o">=</span> <span class="n">stringr</span><span class="o">::</span><span class="nf">str_remove</span><span class="p">(</span><span class="n">Level1</span><span class="p">,</span> <span class="s">&#34;Diff_&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="n">Level2</span> <span class="o">=</span> <span class="n">stringr</span><span class="o">::</span><span class="nf">str_remove</span><span class="p">(</span><span class="n">Level2</span><span class="p">,</span> <span class="s">&#34;Diff_&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="nf">select</span><span class="p">(</span><span class="n">Level1</span><span class="p">,</span> <span class="n">Level2</span><span class="p">,</span> <span class="n">Difference</span><span class="p">,</span> <span class="n">CI_low</span><span class="p">,</span> <span class="n">CI_high</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Visualize results ---------------------------------------------------------</span>
</span></span><span class="line"><span class="cl"><span class="n">p</span> <span class="o">&lt;-</span> <span class="n">modelbased</span><span class="o">::</span><span class="nf">estimate_means</span><span class="p">(</span><span class="n">model</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="nf">arrange</span><span class="p">(</span><span class="n">Mean</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="nf">mutate</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">Method</span> <span class="o">=</span> <span class="n">stringr</span><span class="o">::</span><span class="nf">str_remove</span><span class="p">(</span><span class="n">Method</span><span class="p">,</span> <span class="s">&#34;Diff_&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="n">Method</span> <span class="o">=</span> <span class="nf">factor</span><span class="p">(</span><span class="n">Method</span><span class="p">,</span> <span class="n">levels</span> <span class="o">=</span> <span class="n">Method</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">)</span>  <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">Method</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Mean</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">Method</span><span class="p">))</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">geom_line</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">group</span> <span class="o">=</span> <span class="m">1</span><span class="p">))</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">geom_pointrange</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">ymin</span> <span class="o">=</span> <span class="n">CI_low</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="n">CI_high</span><span class="p">),</span> <span class="n">size</span> <span class="o">=</span> <span class="m">1</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">theme_modern</span><span class="p">()</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">theme</span><span class="p">(</span><span class="n">axis.text.x</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">angle</span> <span class="o">=</span> <span class="m">45</span><span class="p">,</span> <span class="n">hjust</span> <span class="o">=</span> <span class="m">1</span><span class="p">))</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">scale_color_material</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="nf">ggsave</span><span class="p">(</span><span class="s">&#34;featured.png&#34;</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="m">10</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="m">6</span><span class="p">,</span> <span class="n">dpi</span> <span class="o">=</span> <span class="m">450</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">p</span> <span class="o">&lt;-</span> <span class="n">modelbased</span><span class="o">::</span><span class="nf">estimate_relation</span><span class="p">(</span><span class="n">model</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="nf">mutate</span><span class="p">(</span><span class="n">Method</span> <span class="o">=</span> <span class="n">stringr</span><span class="o">::</span><span class="nf">str_remove</span><span class="p">(</span><span class="n">Method</span><span class="p">,</span> <span class="s">&#34;Diff_&#34;</span><span class="p">))</span>  <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">n_Participants</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Predicted</span><span class="p">))</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">geom_point</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="nf">mutate</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">Method</span> <span class="o">=</span> <span class="n">stringr</span><span class="o">::</span><span class="nf">str_remove</span><span class="p">(</span><span class="n">Method</span><span class="p">,</span> <span class="s">&#34;Diff_&#34;</span><span class="p">)),</span>
</span></span><span class="line"><span class="cl">             <span class="nf">aes</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">Diff_Abs</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">Method</span><span class="p">))</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">geom_ribbon</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">ymin</span><span class="o">=</span><span class="n">CI_low</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="n">CI_high</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">Method</span><span class="p">),</span> <span class="n">alpha</span><span class="o">=</span><span class="m">0.1</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">geom_line</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="n">Method</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="m">1</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">theme_modern</span><span class="p">()</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">theme</span><span class="p">(</span><span class="n">axis.text.x</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">angle</span> <span class="o">=</span> <span class="m">45</span><span class="p">,</span> <span class="n">hjust</span> <span class="o">=</span> <span class="m">1</span><span class="p">))</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">scale_color_material</span><span class="p">()</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">scale_fill_material</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="nf">ggsave</span><span class="p">(</span><span class="s">&#34;n_participants.png&#34;</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="m">10</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="m">6</span><span class="p">,</span> <span class="n">dpi</span> <span class="o">=</span> <span class="m">450</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Save results ------------------------------------------------------------</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">d</span> <span class="o">&lt;-</span> <span class="nf">list</span><span class="p">(</span><span class="s">&#34;results&#34;</span> <span class="o">=</span> <span class="n">results</span><span class="p">,</span> <span class="s">&#34;model&#34;</span> <span class="o">=</span> <span class="n">model</span><span class="p">,</span> <span class="s">&#34;contrasts&#34;</span> <span class="o">=</span> <span class="n">contrasts</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">save</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">file</span> <span class="o">=</span> <span class="s">&#34;data.Rdata&#34;</span><span class="p">)</span>
</span></span></code></pre></div><h3 id="references">References</h3>
<p><sub>You can reference this post as follows:</sub></p>
<p><sub>- Makowski, D. (2020, September 14). How to extract individual scores from repeated measures. Retrieved from <a href="https://dominiquemakowski.github.io/post/individual_scores/" target="_blank" rel="noopener">https://dominiquemakowski.github.io/post/individual_scores/</a></sub></p>
<hr>
<p><em>Thanks for reading! Do not hesitate to share this post, and leave a comment below</em> &#x1f917;</p>
<p> <em>And don&rsquo;t forget to join me on Twitter</em> <a href="https://twitter.com/Dom_Makowski" target="_blank" rel="noopener">@Dom_Makowski</a></p>

    </div>

    





<div class="article-tags">
  
  <a class="badge badge-light" href="/tag/statistics/">Statistics</a>
  
  <a class="badge badge-light" href="/tag/r/">R</a>
  
  <a class="badge badge-light" href="/tag/neuropsychology/">Neuropsychology</a>
  
  <a class="badge badge-light" href="/tag/bayesian/">Bayesian</a>
  
  <a class="badge badge-light" href="/tag/individual-scores/">Individual Scores</a>
  
</div>



<div class="share-box">
  <ul class="share">
    
      
      
      
        
      
      
      
      
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Frealitybending.github.io%2Fpost%2F2020-09-14-individual_scores%2F&amp;text=How&#43;to&#43;extract&#43;individual&#43;scores&#43;from&#43;repeated&#43;measures" target="_blank" rel="noopener" class="share-btn-twitter" aria-label="twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=https%3A%2F%2Frealitybending.github.io%2Fpost%2F2020-09-14-individual_scores%2F&amp;t=How&#43;to&#43;extract&#43;individual&#43;scores&#43;from&#43;repeated&#43;measures" target="_blank" rel="noopener" class="share-btn-facebook" aria-label="facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      
      
      
      
        
      
      <li>
        <a href="mailto:?subject=How%20to%20extract%20individual%20scores%20from%20repeated%20measures&amp;body=https%3A%2F%2Frealitybending.github.io%2Fpost%2F2020-09-14-individual_scores%2F" target="_blank" rel="noopener" class="share-btn-email" aria-label="envelope">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=https%3A%2F%2Frealitybending.github.io%2Fpost%2F2020-09-14-individual_scores%2F&amp;title=How&#43;to&#43;extract&#43;individual&#43;scores&#43;from&#43;repeated&#43;measures" target="_blank" rel="noopener" class="share-btn-linkedin" aria-label="linkedin-in">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      
      
      
      
      <li>
        <a href="whatsapp://send?text=How&#43;to&#43;extract&#43;individual&#43;scores&#43;from&#43;repeated&#43;measures%20https%3A%2F%2Frealitybending.github.io%2Fpost%2F2020-09-14-individual_scores%2F" target="_blank" rel="noopener" class="share-btn-whatsapp" aria-label="whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=https%3A%2F%2Frealitybending.github.io%2Fpost%2F2020-09-14-individual_scores%2F&amp;title=How&#43;to&#43;extract&#43;individual&#43;scores&#43;from&#43;repeated&#43;measures" target="_blank" rel="noopener" class="share-btn-weibo" aria-label="weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>











  
  
    



  
  
  
  
  
  <div class="media author-card content-widget-hr">
    
      
      <a href="/authors/dominique-makowski/"><img class="avatar mr-3 avatar-circle" src="/authors/dominique-makowski/avatar_hubc21846e80be5456af5c66dda1aa08ec_14389545_270x270_fill_lanczos_center_3.png" alt="Dominique Makowski"></a>
    

    <div class="media-body">
      <h5 class="card-title"><a href="/authors/dominique-makowski/">Dominique Makowski</a></h5>
      <h6 class="card-subtitle">Lecturer in Psychology</h6>
      <p class="card-text">Trained as neuropsychologist and CBT psychotherapist, I am currently working as a lecturer at the University of Sussex, on the neuroscience of reality perception.</p>
      <ul class="network-icon" aria-hidden="true">
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="/#contact" >
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://twitter.com/Dom_Makowski" target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
    </li>
  
    
    
    
    
    
    
    
      
    
    <li>
      <a href="https://scholar.google.fr/citations?user=bg0BZ-QAAAAJ&amp;hl=en" target="_blank" rel="noopener">
        <i class="ai ai-google-scholar"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://www.researchgate.net/profile/Dominique_Makowski" target="_blank" rel="noopener">
        <i class="fab fa-researchgate"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://github.com/DominiqueMakowski" target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
    </li>
  
</ul>

    </div>
  </div>


  
















  </div>
</article>
  </div>

  <div class="page-footer">
    
    
    <div class="container">
      <footer class="site-footer">

  












  
  
  
  
  













  
  <p class="powered-by copyright-license-text">
     2024 Dominique Makowski
  </p>
  





  <p class="powered-by">
    
    
    
      
      
      
      
      
      
      Published with <a href="https://hugoblox.com/?utm_campaign=poweredby" target="_blank" rel="noopener">Hugo Blox Builder</a>  the free, <a href="https://github.com/HugoBlox/hugo-blox-builder" target="_blank" rel="noopener">open source</a> website builder that empowers creators.
    
  </p>
</footer>

    </div>
    
  </div>

  


<script src="/js/vendor-bundle.min.391d344a129df56f7ad674c2c2ed04e8.js"></script>




  

  
  

  






  <script src="https://cdn.jsdelivr.net/npm/leaflet@1.7.1/dist/leaflet.min.js" integrity="" crossorigin="anonymous"></script>








  
  <script id="search-hit-fuse-template" type="text/x-template">
    <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
    </div>
  </script>
  
    <script src="https://cdn.jsdelivr.net/gh/krisk/Fuse@v3.2.1/dist/fuse.min.js" integrity="sha512-o38bmzBGX+hD3JHWUFCDA09btWaqrNmoJ3RXLlrysA7PP01Kgs4UlE4MhelE1v5dJR3+cxlR4qQlotsW7jKsnw==" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/gh/julmot/mark.js@8.11.1/dist/jquery.mark.min.js" integrity="sha512-mhbv5DqBMgrWL+32MmsDOt/OAvqr/cHimk6B8y/bx/xS88MVkYGPiVv2ixKVrkywF2qHplNRUvFsAHUdxZ3Krg==" crossorigin="anonymous"></script>
  












  
  
  
  
  
  
  

















<script id="page-data" type="application/json">{"use_headroom":true}</script>


  <script src="/js/wowchemy-headroom.db4755770454eb63685f8de785c0a172.js" type="module"></script>









  
  


<script src="/en/js/wowchemy.min.7f5ebaff62ae468cff8bb3dd1337bb9b.js"></script>



  <script src="/js/wowchemy-map.a26e9d2f7238ba5b868384f1c5bc6477.js" type="module"></script>




  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        
        <pre><code></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>


  <script src="/js/wowchemy-publication.9c0e895144aef5a693008b5c5d450147.js" type="module"></script>


















</body>
</html>
